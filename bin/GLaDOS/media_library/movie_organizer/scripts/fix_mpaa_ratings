#!/bin/bash

###############################################################
### This section sets the DIR variable to the current path
### allowing the script to run from anywhere on the filesystem
### as long as the directory structure within this app stays
### intact.
###############################################################
SOURCE="${BASH_SOURCE[0]}"
while [ -h "$SOURCE" ]; do # resolve $SOURCE until the file is no longer a symlink
  DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"
  SOURCE="$(readlink "$SOURCE")"
  [[ $SOURCE != /* ]] && SOURCE="$DIR/$SOURCE" # if $SOURCE was a relative symlink, we need to resolve it relative to the path where the symlink file was located
done
DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"

#############################
### Libraries and Functions
#############################
source $DIR/lib/vars
for f in $DIR/lib/functions/*; do source $f; done
OIFS=$IFS

stringZ=$(echo "select imdb_id from movies where mpaa='NR'" |mysql $dbOptions)
arr=($stringZ)
	for i in ${arr[@]}; do
	  myRating=
	  title=$(echo "select title from movies where imdb_id=\"$i\""|mysql $dbOptions)
	  echo -e "${yellow}$i${NC}      ${red}$title${NC}: "
	  read myRating
	  if [ "$myRating" != "" ]; then
		`echo "update movies set mpaa=\"$myRating\" where imdb_id=\"$i\"" |mysql $dbOptions`
	  fi
	done


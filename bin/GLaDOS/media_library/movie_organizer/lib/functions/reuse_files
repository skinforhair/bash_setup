#!/bin/bash

function download_artwork(){
 case "$2" in
  "poster") URL=${searchTerms[18]};;
  "fanart") URL=${searchTerms[19]};;
  *) URL=${searchTerms[18]};;
 esac
 echo -e "Downloading ${yellow} $2.jpg ${NC}..."
 wget --quiet -O "$1/$2.jpg" "$URL"
} #END download_artwork


function reuse_files() {
# echo -e "Searching ${yellow}$1 ${NC} for files..."

#Grab Poster and Fanart
  for i in jpg srt; do
   if [ -a "$1/$2.$i" ]; then
	 echo -e "Reusing ${yellow}$i${NC} files..."
	 `cp "$1/$2.$i" "$tempPath"`
   fi 
  done

  for i in fanart poster; do
   if [ -a "$1/$i.jpg" ]; then
     `cp "$1/$i.jpg" "$tempPath"`
   else
    download_artwork "$tempPath" "$i"
   fi
  done

#If there isn't a named poster file, create one
  if [ ! -a "$tempPath/$2.jpg" ]; then
 	cp "$tempPath/poster.jpg" "$tempPath/$2.jpg"
  fi

if false; then
 #build an NFO file
 build_nfo "new_nfo"
 if [ -e "$tempPath/$2.nfo" ]; then
  nfoChanged=$(diff "$tempPath/new_nfo.nfo" "$tempPath/$2.nfo")
  if [ "$nfoChanged" != "" ]; then
   echo "NFO updated!"
   rm "$tempPath/$2.nfo"
   mv "$tempPath/new_nfo.nfo" "$tempPath/$2.nfo"
  else
   rm "$tempPath/new_nfo.nfo"
  fi
 else
  mv "$tempPath/new_nfo.nfo" "$tempPath/$2.nfo"
 fi
#update JSON and NFO
 if [ -e "$tempPath/$2.json" ]; then
   jsonChanged=$(diff "$jsonFile" "$tempPath/$2.json")
   if [ "$jsonChanged" != "" ]; then
     echo "JSON updated!"
     rm "$tempPath/$2.json"
     mv "$jsonFile" "$tempPath/$2.json"
     jsonFile="$tempPath/$2.json"
   fi
 else
   mv "$jsonFile" "$tempPath/$2.json"
   jsonFile="$tempPath/$2.json"
 fi
fi
} #END reuse_files

#!/bin/bash

for f in /root/.bin/lib/*; do source $f; done

### - Find local path (See /root/.bin/lib/.localize) ###
SOURCE="${BASH_SOURCE[0]}"
while [ -h "$SOURCE" ]; do
 DIR="$( cd -P "." && pwd )"
 SOURCE="$(readlink "$SOURCE")"
  [[ $SOURCE != /* ]] && SOURCE="$DIR/$SOURCE"
done
DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"
for f in $DIR/lib/functions/*; do source $f; done
source $DIR/lib/vars

 Site="https://www.thetvdb.com/banners/posters/"

 line="$1"
 if [ "$2" == "" ]; then 
   I=2
 else
   I="$2"
 fi

#while read line; do
 #exists=$(ls "/shares/video/tv/$line"|grep poster.jpg)
 #if [ "$exists" == "" ]; then
  echo "Downloading poster for $line..."
  cSN=$(echo "$line" |sed "s;';'';g")
  ShowID=$(echo "select thetvdb_id from tvShows where showname='$cSN'"|mysql $dbOptions)
  #echo "ID: $ShowID"
  path="$Site$ShowID-$I.jpg"
  echo "downloading $path"
  #read -p "any key ot continue..."
  rm "/shares/video/tv/$line/poster.jpg"
  wget "$Site$ShowID-$I.jpg" -O "/shares/video/tv/$line/poster.jpg"
 # exists=
 #fi
#done < showlist



